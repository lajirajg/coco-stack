---
import BaseLayout from "~/layouts/BaseLayout.astro";
import { SITE } from "~/site";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("research");
  return posts
    .filter((p) => !p.data.draft)
    .map((post) => ({ params: { slug: post.slug }, props: { post } }));
}

const { post } = Astro.props as { post: Awaited<ReturnType<typeof getCollection>>[number] };
const { Content } = await post.render();
---

<BaseLayout title={`${post.data.title} - Research - ${SITE.name}`} description={post.data.description}>
  <section class="hero">
    <div class="kicker">Research &amp; PoVs</div>
    <h1 class="headline">{post.data.title}</h1>
    <p class="subhead">{post.data.description}</p>
    <div class="ctaRow" style="margin-top:14px">
      <a class="btn" href="/research">Back to Research</a>
      <a class="btn primary" href="/contact">Discuss</a>
    </div>
  </section>

  <section class="grid" aria-label="Post content">
    <article class="card prose" style="grid-column:span 12">
      <Content />
    </article>
  </section>
</BaseLayout>
